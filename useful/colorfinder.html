<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pro Color Studio</title>
  <link rel="stylesheet" href="../theme.css" />
  <style>
    /* Base Styles */
    body {
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f9fafb;
      color: #111827;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
    }

    h1 {
      font-size: 2rem;
      font-weight: 700;
      margin: 20px 0;
      color: #1f2937;
    }

    /* Tab Navigation */
    .tabs {
      display: flex;
      justify-content: center;
      margin-bottom: 20px;
      border-bottom: 2px solid #e5e7eb;
      width: 100%;
      max-width: 800px;
    }

    .tab {
      flex: 1;
      text-align: center;
      padding: 12px;
      cursor: pointer;
      font-weight: 600;
      color: #6b7280;
      transition: all 0.3s ease;
    }

    .tab.active {
      color: #2563eb;
      border-bottom: 3px solid #2563eb;
    }

    /* Content Panels */
    .tab-content {
      display: none;
      background: white;
      border-radius: 16px;
      padding: 20px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
      width: 100%;
      max-width: 800px;
      animation: fadeIn 0.3s ease-in-out;
    }

    .tab-content.active {
      display: block;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Color Display Card */
    .color-display {
      height: 120px;
      border-radius: 12px;
      border: 1px solid #d1d5db;
      margin: 20px 0;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 1.2em;
      color: #111827;
      box-shadow: inset 0 2px 6px rgba(0,0,0,0.1);
    }

    /* Inputs & Buttons */
    input, button {
      margin: 8px 0;
      padding: 10px 14px;
      border-radius: 8px;
      border: 1px solid #d1d5db;
      font-size: 1rem;
      width: 100%;
      max-width: 400px;
      box-sizing: border-box;
    }

    button {
      background: #2563eb;
      color: white;
      border: none;
      cursor: pointer;
      font-weight: 600;
      transition: background 0.3s ease;
    }

    button:hover {
      background: #1d4ed8;
    }

    /* Responsive */
    @media (max-width: 600px) {
      .tab {
        font-size: 0.9rem;
        padding: 10px;
      }
      h1 {
        font-size: 1.5rem;
      }
    }
  </style>
</head>
<body>
    <button class="menu-btn" onclick="toggleSidebar()">‚ò∞ Menu</button>
    <div class="sidebar" id="sidebar">
        <div class="clock" id="clock"></div>
	<div id="sidebar-nav"></div>
        <button class="theme-toggle" onclick="toggleTheme()">üåì Toggle Theme</button>
    </div>
  <h1>Pro Color Studio</h1>

  <!-- Tabs -->
  <div class="tabs">
    <div class="tab active" onclick="openTab('generator')">üé® Generator</div>
    <div class="tab" onclick="openTab('picker')">üåà Picker</div>
    <div class="tab" onclick="openTab('image')">üñºÔ∏è Image</div>
  </div>

  <!-- Generator Tab -->
  <div id="generator" class="tab-content active">
    <button onclick="generateColor()">Generate Random Color</button>
    <div id="genDisplay" class="color-display">#FFFFFF</div>
    <p id="genHex"></p>
    <p id="genRgba"></p>
    <p id="genName"></p>
  </div>

  <!-- Picker Tab -->
  <div id="picker" class="tab-content">
    <input type="color" id="colorPicker" value="#ff0000" oninput="updatePicker(this.value)">
    <div id="pickDisplay" class="color-display">#FF0000</div>
    <p id="pickHex"></p>
    <p id="pickRgba"></p>
    <p id="pickName"></p>
    <input type="text" id="manualInput" placeholder="Enter HEX or RGBA" oninput="manualColor(this.value)">
  </div>

  <!-- Image Tab -->
  <div id="image" class="tab-content">
    <input type="file" id="imageUpload" accept="image/*" onchange="loadImage(event)">
    <canvas id="canvas" style="max-width:100%; margin-top:15px; border-radius:12px; border:1px solid #ddd;"></canvas>
    <div id="imgDisplay" class="color-display">Pick a color</div>
    <p id="imgHex"></p>
    <p id="imgRgba"></p>
    <p id="imgName"></p>
  </div>

  <script>
    /* Tab Switching */
    function openTab(tabId) {
      document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
      document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
      document.querySelector(`.tab[onclick="openTab('${tabId}')"]`).classList.add('active');
      document.getElementById(tabId).classList.add('active');
    }

    /* Helper: Convert HEX to RGBA */
    function hexToRgba(hex) {
      let r = parseInt(hex.slice(1, 3), 16);
      let g = parseInt(hex.slice(3, 5), 16);
      let b = parseInt(hex.slice(5, 7), 16);
      return `rgba(${r}, ${g}, ${b}, 1)`;
    }

    /* Helper: Guess Color Name (basic set) */
    function getColorName(hex) {
      const names = {
        "#ff0000": "Red",
        "#00ff00": "Lime",
        "#0000ff": "Blue",
        "#ffff00": "Yellow",
        "#ffa500": "Orange",
        "#800080": "Purple",
        "#000000": "Black",
        "#ffffff": "White",
        "#808080": "Gray"
      };
      return names[hex.toLowerCase()] || "Custom Color";
    }

    /* Generator */
    function generateColor() {
      let hex = "#" + Math.floor(Math.random()*16777215).toString(16).padStart(6, '0');
      let rgba = hexToRgba(hex);
      document.getElementById("genDisplay").style.background = hex;
      document.getElementById("genDisplay").textContent = hex;
      document.getElementById("genHex").textContent = "HEX: " + hex;
      document.getElementById("genRgba").textContent = "RGBA: " + rgba;
      document.getElementById("genName").textContent = "Name: " + getColorName(hex);
    }

    /* Picker */
    function updatePicker(hex) {
      let rgba = hexToRgba(hex);
      document.getElementById("pickDisplay").style.background = hex;
      document.getElementById("pickDisplay").textContent = hex;
      document.getElementById("pickHex").textContent = "HEX: " + hex;
      document.getElementById("pickRgba").textContent = "RGBA: " + rgba;
      document.getElementById("pickName").textContent = "Name: " + getColorName(hex);
    }

    /* Manual Input */
    function manualColor(value) {
      let hexMatch = value.match(/^#([0-9A-F]{6})$/i);
      let rgbaMatch = value.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*([\d.]+))?\)$/i);
      let hex, rgba;
      if (hexMatch) {
        hex = value;
        rgba = hexToRgba(hex);
      } else if (rgbaMatch) {
        rgba = value;
        let r = parseInt(rgbaMatch[1]), g = parseInt(rgbaMatch[2]), b = parseInt(rgbaMatch[3]);
        hex = "#" + [r,g,b].map(x => x.toString(16).padStart(2, '0')).join('');
      }
      if (hex && rgba) {
        document.getElementById("pickDisplay").style.background = hex;
        document.getElementById("pickDisplay").textContent = hex;
        document.getElementById("pickHex").textContent = "HEX: " + hex;
        document.getElementById("pickRgba").textContent = "RGBA: " + rgba;
        document.getElementById("pickName").textContent = "Name: " + getColorName(hex);
      }
    }

/* Image Upload & Click (Fixed for scaling) */
function loadImage(event) {
  const canvas = document.getElementById("canvas");
  const ctx = canvas.getContext("2d");
  const img = new Image();
  
  img.onload = () => {
    // Fit canvas to container width
    const maxWidth = canvas.parentElement.offsetWidth - 20;
    const scale = Math.min(maxWidth / img.width, 500 / img.height); // limit max height to 500px for mobile
    canvas.width = img.width * scale;
    canvas.height = img.height * scale;
    
    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);

    // Save scale + image for coordinate mapping
    canvas.dataset.scaleX = img.width / canvas.width;
    canvas.dataset.scaleY = img.height / canvas.height;
    canvas.dataset.imgSrc = img.src;
  };
  
  img.src = URL.createObjectURL(event.target.files[0]);

  canvas.onclick = function(e) {
    const rect = canvas.getBoundingClientRect();
    const x = Math.floor((e.clientX - rect.left) * canvas.dataset.scaleX);
    const y = Math.floor((e.clientY - rect.top) * canvas.dataset.scaleY);

    // Create hidden buffer canvas to get original pixel (not stretched one)
    const buffer = document.createElement("canvas");
    buffer.width = img.width;
    buffer.height = img.height;
    buffer.getContext("2d").drawImage(img, 0, 0);
    const data = buffer.getContext("2d").getImageData(x, y, 1, 1).data;

    const hex = "#" + [data[0], data[1], data[2]].map(x => x.toString(16).padStart(2,'0')).join('');
    const rgba = `rgba(${data[0]}, ${data[1]}, ${data[2]}, ${(data[3]/255).toFixed(2)})`;

    document.getElementById("imgDisplay").style.background = hex;
    document.getElementById("imgDisplay").textContent = hex;
    document.getElementById("imgHex").textContent = "HEX: " + hex;
    document.getElementById("imgRgba").textContent = "RGBA: " + rgba;
    document.getElementById("imgName").textContent = "Name: " + getColorName(hex);
  };
}
  </script>
  <script>
      function navigateTo(page) {
        window.location.href = page;
    }

    function toggleSidebar() {
        const sidebar = document.getElementById('sidebar');
        sidebar.classList.toggle('open');
    }
        // Close sidebar if clicked outside of it
    document.addEventListener('click', function(event) {
	const sidebar = document.getElementById('sidebar');
        const menuButton = document.querySelector('.menu-btn');
        if (!sidebar.contains(event.target) && !menuButton.contains(event.target)) {
            sidebar.classList.remove('open');
        }
    });

    function updateClock() {
        const now = new Date();
        const timeString = now.toLocaleTimeString();
        document.getElementById('clock').textContent = timeString;
    }
    fetch('sidebar.html')
	    .then(response => response.text())
	    .then(data => {
		document.getElementById('sidebar-nav').innerHTML = data;
    	    });
	
    setInterval(updateClock, 1000);
    updateClock();
 </script>
</body>
</html>
