<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Date Countdown Tool</title>
<style>
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body {
    font-family: "Segoe UI", Roboto, Arial, sans-serif;
    background: linear-gradient(135deg, #1d2b64, #f8cdda);
    min-height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 20px;
    color: #fff;
  }

  .card {
    background: rgba(255,255,255,0.08);
    backdrop-filter: blur(12px);
    border-radius: 20px;
    padding: 40px 30px;
    width: 100%;
    max-width: 420px;
    box-shadow: 0 8px 32px rgba(0,0,0,0.25);
    animation: fadeIn 0.8s ease-out;
  }

  h2 { text-align:center; font-size:1.8rem; margin-bottom:25px; }

  label { display:block; margin:18px 0 6px; font-weight:500; font-size:0.95rem; }

  input[type="date"] { padding:10px; width:100%; border-radius:10px; border:none; outline:none; font-size:0.95rem; background:rgba(255,255,255,0.2); color:#fff; transition: all 0.3s ease; }
  input[type="date"]:focus { background: rgba(255,255,255,0.3); }

  .checkbox-group { display:flex; align-items:center; margin-top:12px; }
  .checkbox-group label { margin-left:8px; font-weight:normal; font-size:0.9rem; }

  button.calc-btn {
    width:100%; background: linear-gradient(135deg,#4facfe,#00f2fe);
    color:#fff; font-size:1rem; font-weight:bold; padding:14px; margin-top:25px;
    border:none; border-radius:12px; cursor:pointer; box-shadow:0 4px 12px rgba(0,0,0,0.2);
    transition: all 0.3s ease;
  }
  button.calc-btn:hover { transform: translateY(-2px); box-shadow:0 6px 16px rgba(0,0,0,0.25); }

  #result {
    margin-top:25px; padding:20px; border-radius:12px; font-size:1rem; line-height:1.5;
    white-space: pre-line; background: rgba(255,255,255,0.1); border-left: 4px solid #4facfe;
    animation: slideUp 0.6s ease-out;
  }

  /* Sidebar */
  .sidebar {
    position: fixed; left: -260px; top: 0; width: 240px; height: 100%;
    background: rgba(255,255,255,0.08); backdrop-filter: blur(12px);
    padding: 20px; box-shadow:5px 0 15px rgba(0,0,0,0.5);
    transition: left 0.3s ease; z-index: 1000; color:#fff;
  }
  .sidebar.open { left:0; }

  .sidebar button.sidebar-btn {
    display:block; background: rgba(255,255,255,0.1); border:none;
    color:#fff; font-size:1rem; padding:12px; margin-bottom:12px;
    width:100%; text-align:left; border-radius:10px; cursor:pointer;
    transition: transform 0.2s ease, background 0.3s ease;
  }
  .sidebar button.sidebar-btn:hover { background: rgba(255,255,255,0.2); transform: scale(1.05); }

  /* Menu Button */
  .menu-btn {
    position: fixed; top:15px; left:15px;
    background: rgba(255,255,255,0.2); backdrop-filter: blur(10px);
    color:#fff; font-size:1rem; padding:8px 12px; border:none; border-radius:8px;
    cursor:pointer; z-index:1100; box-shadow:0 4px 12px rgba(0,0,0,0.3);
    transition: transform 0.2s ease, background 0.3s ease;
  }
  .menu-btn:hover { transform: scale(1.05); background: rgba(255,255,255,0.3); }

  @keyframes fadeIn { from { opacity:0; transform: scale(0.95); } to { opacity:1; transform: scale(1); } }
  @keyframes slideUp { from { opacity:0; transform: translateY(20px); } to { opacity:1; transform: translateY(0); } }

</style>
</head>
<body>
<button class="menu-btn" id="menuBtn">â˜°</button>

<div class="sidebar" id="sidebar">
  <div class="clock" id="clock"></div>
  <div id="sidebar-nav"></div>
</div>

<div class="card">
  <h2>Future Date Countdown</h2>
  <label>Select a date:</label>
  <input type="date" id="targetDate">

  <div class="checkbox-group">
    <input type="checkbox" id="excludeWeekends">
    <label for="excludeWeekends">Exclude weekends</label>
  </div>
  <div class="checkbox-group">
    <input type="checkbox" id="excludeHolidays">
    <label for="excludeHolidays">Exclude US federal holidays</label>
  </div>

  <button class="calc-btn" onclick="calculateDays()">Calculate</button>
  <h3 id="result"></h3>
</div>

<script>
  const sidebar = document.getElementById('sidebar');
  const menuBtn = document.getElementById('menuBtn');

  // Open sidebar & hide menu button
  menuBtn.addEventListener('click', () => {
    sidebar.classList.add('open');
    menuBtn.style.display = 'none';
  });

  // Click outside to close sidebar
  document.addEventListener('click', (e) => {
    if (!sidebar.contains(e.target) && !menuBtn.contains(e.target)) {
      sidebar.classList.remove('open');
      menuBtn.style.display = 'block';
    }
  });

  // Load navbar.html into sidebar
  fetch('navbar.html')
    .then(res => res.text())
    .then(html => { document.getElementById('sidebar-nav').innerHTML = html; });

  // Live clock
  function updateClock() {
    const now = new Date();
    document.getElementById('clock').innerText = now.toLocaleTimeString();
  }
  setInterval(updateClock,1000);
  updateClock();

  async function getFederalHolidays(year) {
    try {
      const res = await fetch("https://date.nager.at/api/v3/PublicHolidays/" + year + "/US");
      if(!res.ok) throw new Error("Failed to fetch holidays");
      const data = await res.json();
      return data.map(h=>h.date);
    } catch(e){console.error(e); return [];}
  }

  async function calculateDays() {
    const targetDate = new Date(document.getElementById("targetDate").value);
    const excludeWeekends = document.getElementById("excludeWeekends").checked;
    const excludeHolidays = document.getElementById("excludeHolidays").checked;
    if (isNaN(targetDate)) { document.getElementById("result").innerText="Please select a valid date."; return; }

    const today = new Date(); today.setHours(0,0,0,0);
    let totalDays = Math.ceil((targetDate - today)/(1000*60*60*24)), count=0;
    let federalHolidays = excludeHolidays ? await getFederalHolidays(targetDate.getFullYear()) : [];

    let tempDate = new Date(today); tempDate.setDate(tempDate.getDate()+1);
    for (let i=1;i<=totalDays;i++){
      const iso=tempDate.toISOString().split("T")[0], day=tempDate.getDay();
      let skip=false;
      if(excludeWeekends&&(day===0||day===6)) skip=true;
      if(excludeHolidays && federalHolidays.includes(iso)) skip=true;
      if(!skip) count++;
      tempDate.setDate(tempDate.getDate()+1);
    }
    document.getElementById("result").innerText=
      "Total days until selected date: "+totalDays+"\nDays (with options applied): "+count;
  }
</script>
</body>
</html>
