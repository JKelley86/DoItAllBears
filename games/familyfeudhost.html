<!DOCTYPE html>
<html>
<head>
  <title>Family Feud Host</title>
  <style>
    body { font-family: Arial; background: #222; color: #fff; text-align: center; }
    #question { font-size: 2em; margin-top: 20px; }
    .answer-list { margin-top: 20px; display: flex; flex-direction: column; align-items: center; }
    .answer-item { background: #333; padding: 10px 20px; margin: 5px; border-radius: 8px; width: 300px; display: flex; justify-content: space-between; align-items: center; }
    .btn-group { display: flex; gap: 10px; }
    .btn { background: #555; color: white; padding: 5px 10px; border: none; border-radius: 5px; cursor: pointer; }
    .btn:hover { background: #777; }
    #team-scores { margin: 20px; }
  </style>
</head>
<body>
  <h1>Family Feud Host Panel</h1>
  <div id="question">Press Load Questions to Start</div>
  <div class="answer-list" id="answers"></div>
  <div>
    <button onclick="nextRound()" class="btn">Next Round</button>
    <button onclick="loadQuestions()" class="btn">Load Questions</button>
  </div>
  <div id="team-scores">
    <h2>Scores</h2>
    <p>Team A: <span id="scoreA">0</span></p>
    <p>Team B: <span id="scoreB">0</span></p>
  </div>

  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-database-compat.js"></script>
  <script>
    // Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyC...",
      authDomain: "your-project.firebaseapp.com",
      projectId: "your-project-id",
      databaseURL: "https://your-project-id.firebaseio.com",
      storageBucket: "your-project.appspot.com",
      messagingSenderId: "SENDER_ID",
      appId: "APP_ID"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    let questions = [];
    let currentQuestionIndex = 0;
    let teamScores = { A: 0, B: 0 };

    function loadQuestions() {
      fetch("https://docs.google.com/spreadsheets/d/e/2PACX-1vT8hWnxpAnGUMSl7VqP4rRFALVpaQ4LCd46XU_lyio6qSv847jmUUTX8EsQ3gRZ2db0hwTMVYfYlIPj/pub?output=csv")
        .then(res => res.text())
        .then(csv => {
          const lines = csv.trim().split("\n");
          const headers = lines[0].split(",");
          questions = [];

          for (let i = 1; i < lines.length; i++) {
            const cols = lines[i].split(",");
            const question = cols[0];
            const answers = [];

            for (let j = 1; j < cols.length; j += 2) {
              if (cols[j]) {
                answers.push({ text: cols[j], points: parseInt(cols[j + 1]) || 0, revealed: false });
              }
            }

            questions.push({ question, answers });
          }

          currentQuestionIndex = 0;
          showQuestion();
        });
    }

    function showQuestion() {
      const q = questions[currentQuestionIndex];
      document.getElementById("question").innerText = q.question;

      const answerContainer = document.getElementById("answers");
      answerContainer.innerHTML = "";

      q.answers.forEach((ans, idx) => {
        const div = document.createElement("div");
        div.className = "answer-item";
        div.innerHTML = `
          <span>${ans.revealed ? `${ans.text} (${ans.points})` : "-----"}</span>
          <div class="btn-group">
            <button class="btn" onclick="revealAnswer(${idx}, 'A')">Team A</button>
            <button class="btn" onclick="revealAnswer(${idx}, 'B')">Team B</button>
          </div>
        `;
        answerContainer.appendChild(div);
      });

      // Sync to players
      db.ref("game/currentQuestion").set(q.question);
      db.ref("game/answers").set(q.answers.map(a => a.revealed ? `${a.text} (${a.points})` : "-----"));
    }

    function revealAnswer(index, team) {
      const q = questions[currentQuestionIndex];
      if (!q.answers[index].revealed) {
        q.answers[index].revealed = true;
        teamScores[team] += q.answers[index].points;
        document.getElementById(`score${team}`).innerText = teamScores[team];
        db.ref("game/scores").set(teamScores);
        showQuestion(); // re-render with updated answer
      }
    }

    function nextRound() {
      currentQuestionIndex++;
      if (currentQuestionIndex < questions.length) {
        showQuestion();
      } else {
        alert("Game over!");
        db.ref("game/currentQuestion").set("Game Over");
        db.ref("game/answers").set([]);
      }
    }
  </script>
</body>
</html>
