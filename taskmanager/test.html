<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Taskline - Focus Task Manager</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Caveat:wght@400;500;600;700&display=swap');
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            -webkit-font-smoothing: antialiased;
            background-color: #0f172a;
        }
        
        body.notebook-theme {
            background-color: #2c2416;
        }
        
        .task-urgent { border-left: 6px solid #ef4444; }
        .task-semi-urgent { border-left: 6px solid #f59e0b; }
        .task-not-urgent { border-left: 6px solid #10b981; }
        
        .blitz-shadow {
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.3), 0 1px 2px -1px rgba(0, 0, 0, 0.3);
        }
        
        .blitz-shadow-lg {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.4), 0 4px 6px -4px rgba(0, 0, 0, 0.4);
        }
        
        .notebook-paper {
            background-color: #f4e4c1;
            background-image: 
                repeating-linear-gradient(
                    0deg,
                    transparent,
                    transparent 31px,
                    #e8d4a8 31px,
                    #e8d4a8 32px
                );
        }
        
        .notebook-handwriting {
            font-family: 'Caveat', cursive;
        }
        
        .modal-backdrop {
            backdrop-filter: blur(4px);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const firebaseConfig = {
            apiKey: "AIzaSyDSVL3g2WINSdnT41O4QhkOhuh5CGRGEPs",
            authDomain: "task-manager-e9cd9.firebaseapp.com",
            databaseURL: "https://task-manager-e9cd9-default-rtdb.firebaseio.com",
            projectId: "task-manager-e9cd9",
            storageBucket: "task-manager-e9cd9.firebasestorage.app",
            messagingSenderId: "38849678992",
            appId: "1:38849678992:web:f39c4937951853fb29d215"
        };

        if (!firebase.apps.length) {
            firebase.initializeApp(firebaseConfig);
        }
        const auth = firebase.auth();
        const database = firebase.database();

        // Icons
        const Calendar = (props) => React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", width: props.size || 24, height: props.size || 24, viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", className: props.className }, React.createElement('rect', { x: "3", y: "4", width: "18", height: "18", rx: "2", ry: "2" }), React.createElement('line', { x1: "16", y1: "2", x2: "16", y2: "6" }), React.createElement('line', { x1: "8", y1: "2", x2: "8", y2: "6" }), React.createElement('line', { x1: "3", y1: "10", x2: "21", y2: "10" }));
        const Clock = (props) => React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", width: props.size || 24, height: props.size || 24, viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", className: props.className }, React.createElement('circle', { cx: "12", cy: "12", r: "10" }), React.createElement('polyline', { points: "12 6 12 12 16 14" }));
        const Play = (props) => React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", width: props.size || 24, height: props.size || 24, viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", className: props.className }, React.createElement('polygon', { points: "5 3 19 12 5 21 5 3" }));
        const Pause = (props) => React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", width: props.size || 24, height: props.size || 24, viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", className: props.className }, React.createElement('rect', { x: "6", y: "4", width: "4", height: "16" }), React.createElement('rect', { x: "14", y: "4", width: "4", height: "16" }));
        const X = (props) => React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", width: props.size || 24, height: props.size || 24, viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", className: props.className }, React.createElement('line', { x1: "18", y1: "6", x2: "6", y2: "18" }), React.createElement('line', { x1: "6", y1: "6", x2: "18", y2: "18" }));
        const GripVertical = (props) => React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", width: props.size || 24, height: props.size || 24, viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", className: props.className }, React.createElement('circle', { cx: "9", cy: "12", r: "1" }), React.createElement('circle', { cx: "9", cy: "5", r: "1" }), React.createElement('circle', { cx: "9", cy: "19", r: "1" }), React.createElement('circle', { cx: "15", cy: "12", r: "1" }), React.createElement('circle', { cx: "15", cy: "5", r: "1" }), React.createElement('circle', { cx: "15", cy: "19", r: "1" }));
        const Plus = (props) => React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", width: props.size || 24, height: props.size || 24, viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", className: props.className }, React.createElement('line', { x1: "12", y1: "5", x2: "12", y2: "19" }), React.createElement('line', { x1: "5", y1: "12", x2: "19", y2: "12" }));
        const Check = (props) => React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", width: props.size || 24, height: props.size || 24, viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", className: props.className }, React.createElement('polyline', { points: "20 6 9 17 4 12" }));
        const ChevronLeft = (props) => React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", width: props.size || 24, height: props.size || 24, viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", className: props.className }, React.createElement('polyline', { points: "15 18 9 12 15 6" }));
        const ChevronRight = (props) => React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", width: props.size || 24, height: props.size || 24, viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", className: props.className }, React.createElement('polyline', { points: "9 18 15 12 9 6" }));
        const LogOut = (props) => React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", width: props.size || 24, height: props.size || 24, viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", className: props.className }, React.createElement('path', { d: "M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" }), React.createElement('polyline', { points: "16 17 21 12 16 7" }), React.createElement('line', { x1: "21", y1: "12", x2: "9", y2: "12" }));
        const AlertCircle = (props) => React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", width: props.size || 24, height: props.size || 24, viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", className: props.className }, React.createElement('circle', { cx: "12", cy: "12", r: "10" }), React.createElement('line', { x1: "12", y1: "8", x2: "12", y2: "12" }), React.createElement('line', { x1: "12", y1: "16", x2: "12.01", y2: "16" }));
        const Book = (props) => React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", width: props.size || 24, height: props.size || 24, viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", className: props.className }, React.createElement('path', { d: "M4 19.5A2.5 2.5 0 0 1 6.5 17H20" }), React.createElement('path', { d: "M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z" }));
        const Sparkles = (props) => React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", width: props.size || 24, height: props.size || 24, viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", className: props.className }, React.createElement('path', { d: "m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z" }), React.createElement('path', { d: "M5 3v4" }), React.createElement('path', { d: "M19 17v4" }), React.createElement('path', { d: "M3 5h4" }), React.createElement('path', { d: "M17 19h4" }));
        const Moon = (props) => React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", width: props.size || 24, height: props.size || 24, viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", className: props.className }, React.createElement('path', { d: "M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" }));
        const Send = (props) => React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", width: props.size || 24, height: props.size || 24, viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", className: props.className }, React.createElement('line', { x1: "22", y1: "2", x2: "11", y2: "13" }), React.createElement('polygon', { points: "22 2 15 22 11 13 2 9 22 2" }));
        const Copy = (props) => React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", width: props.size || 24, height: props.size || 24, viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", className: props.className }, React.createElement('rect', { x: "9", y: "9", width: "13", height: "13", rx: "2", ry: "2" }), React.createElement('path', { d: "M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" }));

        const FocusTaskManager = () => {
            const [user, setUser] = useState(null);
            const [email, setEmail] = useState('');
            const [password, setPassword] = useState('');
            const [tasks, setTasks] = useState([]);
            const [newTaskTitle, setNewTaskTitle] = useState('');
            const [newTaskTime, setNewTaskTime] = useState(30);
            const [newTaskDate, setNewTaskDate] = useState(new Date().toISOString().split('T')[0]);
            const [newTaskUrgency, setNewTaskUrgency] = useState('not-urgent');
            const [view, setView] = useState('today');
            const [selectedDate, setSelectedDate] = useState(new Date());
            const [focusMode, setFocusMode] = useState(null);
            const [timerSeconds, setTimerSeconds] = useState(0);
            const [isTimerRunning, setIsTimerRunning] = useState(false);
            const [isMinimized, setIsMinimized] = useState(false);
            const [loading, setLoading] = useState(true);
            const [theme, setTheme] = useState(() => localStorage.getItem('taskline-theme') || 'dark');
            const [touchStartY, setTouchStartY] = useState(null);
            const [touchedTask, setTouchedTask] = useState(null);
            const [showAIModal, setShowAIModal] = useState(false);
            const [aiPrompt, setAiPrompt] = useState('');
            const [aiResponse, setAiResponse] = useState('');
            const [aiLoading, setAiLoading] = useState(false);
            // HARDCODED API KEY - KEEP THIS FILE PRIVATE!
            const HARDCODED_API_KEY = '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'; // Replace with your actual Groq API key
            const [groqApiKey, setGroqApiKey] = useState(() => HARDCODED_API_KEY || localStorage.getItem('groq-api-key') || '');
            const [showApiKeyInput, setShowApiKeyInput] = useState(false);
            const timerRef = useRef(null);

            useEffect(() => {
                document.body.className = theme === 'notebook' ? 'notebook-theme' : '';
                localStorage.setItem('taskline-theme', theme);
            }, [theme]);

            useEffect(() => {
                const unsubscribe = auth.onAuthStateChanged((user) => {
                    setUser(user);
                    setLoading(false);
                });
                return () => unsubscribe();
            }, []);

            useEffect(() => {
                if (user) {
                    const tasksRef = database.ref(`users/${user.uid}/tasks`);
                    tasksRef.on('value', (snapshot) => {
                        const data = snapshot.val();
                        if (data) {
                            const taskArray = Object.keys(data).map(key => ({
                                id: key,
                                ...data[key]
                            }));
                            setTasks(taskArray);
                        } else {
                            setTasks([]);
                        }
                    });
                    return () => tasksRef.off();
                }
            }, [user]);

            useEffect(() => {
                if (isTimerRunning && focusMode) {
                    timerRef.current = setInterval(() => {
                        setTimerSeconds(prev => {
                            if (prev >= focusMode.time * 60) {
                                setIsTimerRunning(false);
                                return prev;
                            }
                            return prev + 1;
                        });
                    }, 1000);
                } else {
                    if (timerRef.current) clearInterval(timerRef.current);
                }
                return () => {
                    if (timerRef.current) clearInterval(timerRef.current);
                };
            }, [isTimerRunning, focusMode]);

            const signUp = async () => {
                try {
                    await auth.createUserWithEmailAndPassword(email, password);
                } catch (error) {
                    alert(error.message);
                }
            };

            const signIn = async () => {
                try {
                    await auth.signInWithEmailAndPassword(email, password);
                } catch (error) {
                    alert(error.message);
                }
            };

            const signOut = async () => {
                await auth.signOut();
                setTasks([]);
            };

            const addTask = async () => {
                if (newTaskTitle.trim() && user) {
                    const newTaskRef = database.ref(`users/${user.uid}/tasks`).push();
                    await newTaskRef.set({
                        title: newTaskTitle,
                        time: newTaskTime,
                        urgency: newTaskUrgency,
                        completed: false,
                        date: newTaskDate,
                        createdAt: Date.now()
                    });
                    setNewTaskTitle('');
                    setNewTaskTime(30);
                    setNewTaskUrgency('not-urgent');
                }
            };

            const completeTask = async (id) => {
                if (user) {
                    await database.ref(`users/${user.uid}/tasks/${id}`).update({ completed: true });
                }
            };

            const deleteTask = async (id) => {
                if (user) {
                    await database.ref(`users/${user.uid}/tasks/${id}`).remove();
                }
            };

            const handleTouchStart = (e, task) => {
                setTouchStartY(e.touches[0].clientY);
                setTouchedTask(task);
            };

            const handleTouchMove = (e) => {
                if (touchStartY === null || touchedTask === null) return;
                const touchEndY = e.touches[0].clientY;
                const diff = touchStartY - touchEndY;
                
                if (Math.abs(diff) > 10) {
                    e.preventDefault();
                }
            };

            const handleTouchEnd = (e, targetTask) => {
                if (touchStartY === null || touchedTask === null) return;
                
                const touchEndY = e.changedTouches[0].clientY;
                const diff = touchStartY - touchEndY;
                
                if (Math.abs(diff) > 50 && touchedTask.id !== targetTask.id) {
                    const draggedIdx = tasks.findIndex(t => t.id === touchedTask.id);
                    const targetIdx = tasks.findIndex(t => t.id === targetTask.id);
                    const newTasks = [...tasks];
                    newTasks.splice(draggedIdx, 1);
                    
                    if (diff > 0) {
                        newTasks.splice(targetIdx, 0, touchedTask);
                    } else {
                        newTasks.splice(targetIdx + 1, 0, touchedTask);
                    }
                    
                    setTasks(newTasks);
                }
                
                setTouchStartY(null);
                setTouchedTask(null);
            };

            const handleDragStart = (e, task) => {
                e.dataTransfer.effectAllowed = 'move';
                e.dataTransfer.setData('text/html', e.target);
                setTouchedTask(task);
            };

            const handleDragOver = (e) => {
                e.preventDefault();
                e.dataTransfer.dropEffect = 'move';
            };

            const handleDrop = (e, targetTask) => {
                e.preventDefault();
                if (touchedTask && touchedTask.id !== targetTask.id) {
                    const draggedIdx = tasks.findIndex(t => t.id === touchedTask.id);
                    const targetIdx = tasks.findIndex(t => t.id === targetTask.id);
                    const newTasks = [...tasks];
                    newTasks.splice(draggedIdx, 1);
                    newTasks.splice(targetIdx, 0, touchedTask);
                    setTasks(newTasks);
                }
                setTouchedTask(null);
            };

            const startFocusMode = (task) => {
                setFocusMode(task);
                setTimerSeconds(0);
                setIsTimerRunning(true);
                setIsMinimized(false);
            };

            const exitFocusMode = () => {
                setFocusMode(null);
                setTimerSeconds(0);
                setIsTimerRunning(false);
                setIsMinimized(false);
            };

            const formatTime = (seconds) => {
                const mins = Math.floor(seconds / 60);
                const secs = seconds % 60;
                return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            };

            const getUrgencyClass = (urgency) => {
                switch(urgency) {
                    case 'urgent': return 'task-urgent';
                    case 'semi-urgent': return 'task-semi-urgent';
                    case 'not-urgent': return 'task-not-urgent';
                    default: return 'task-not-urgent';
                }
            };

            const getUrgencyColor = (urgency) => {
                switch(urgency) {
                    case 'urgent': return 'bg-red-500';
                    case 'semi-urgent': return 'bg-amber-500';
                    case 'not-urgent': return 'bg-green-500';
                    default: return 'bg-green-500';
                }
            };

            const toggleTheme = () => {
                setTheme(theme === 'dark' ? 'notebook' : 'dark');
            };

            const saveApiKey = () => {
                localStorage.setItem('groq-api-key', groqApiKey);
                setShowApiKeyInput(false);
            };

            const callAI = async () => {
                if (!groqApiKey || groqApiKey === 'YOUR_API_KEY_HERE') {
                    alert('Please add your Groq API key first!');
                    setShowApiKeyInput(true);
                    return;
                }

                setAiLoading(true);
                setAiResponse('');
                try {
                    const response = await fetch('https://api.groq.com/openai/v1/chat/completions', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${groqApiKey}`
                        },
                        body: JSON.stringify({
                            model: 'llama-3.3-70b-versatile',
                            messages: [
                                { role: 'user', content: aiPrompt }
                            ],
                            temperature: 0.7,
                            max_tokens: 2000
                        })
                    });

                    const data = await response.json();
                    if (data.choices && data.choices[0] && data.choices[0].message) {
                        setAiResponse(data.choices[0].message.content);
                    } else if (data.error) {
                        setAiResponse(`Error: ${data.error.message || JSON.stringify(data.error)}`);
                    }
                } catch (error) {
                    setAiResponse(`Error: ${error.message}`);
                }
                setAiLoading(false);
            };

            const copyToClipboard = (text) => {
                navigator.clipboard.writeText(text);
                alert('Copied to clipboard!');
            };

            const quickActions = [
                { label: 'ðŸ“§ Draft Email', prompt: 'Write a professional email about: ' },
                { label: 'ðŸ’¡ Talking Points', prompt: 'Create talking points for: ' },
                { label: 'âœï¸ Rewrite/Improve', prompt: 'Rewrite and improve this: ' },
                { label: 'ðŸ§  Brainstorm', prompt: 'Brainstorm ideas for: ' },
                { label: 'ðŸ“ Summarize', prompt: 'Summarize this: ' },
                { label: 'ðŸŽ¯ Action Items', prompt: 'Extract action items from: ' }
            ];

            const todayStr = new Date().toISOString().split('T')[0];
            const activeTasks = view === 'today' 
                ? tasks.filter(t => !t.completed && t.date <= todayStr)
                : tasks.filter(t => !t.completed && t.date === selectedDate.toISOString().split('T')[0]);
            
            const completedTasks = view === 'today'
                ? tasks.filter(t => t.completed && t.date === todayStr)
                : tasks.filter(t => t.completed && t.date === selectedDate.toISOString().split('T')[0]);

            const getDaysInMonth = (date) => {
                const year = date.getFullYear();
                const month = date.getMonth();
                const firstDay = new Date(year, month, 1);
                const lastDay = new Date(year, month + 1, 0);
                const daysInMonth = lastDay.getDate();
                const startingDayOfWeek = firstDay.getDay();
                return { daysInMonth, startingDayOfWeek };
            };

            const changeMonth = (direction) => {
                setSelectedDate(new Date(selectedDate.getFullYear(), selectedDate.getMonth() + direction, 1));
            };

            const getTasksForDate = (date) => {
                const dateStr = date.toISOString().split('T')[0];
                return tasks.filter(t => t.date === dateStr).length;
            };

            const isOverdue = (taskDate) => {
                return taskDate < todayStr;
            };

            // Theme styles
            const isDark = theme === 'dark';
            const themeClasses = {
                bg: isDark ? 'bg-slate-900' : 'bg-stone-100',
                card: isDark ? 'bg-slate-800 border-slate-700' : 'notebook-paper border-stone-300',
                text: isDark ? 'text-white' : 'text-stone-800',
                textSecondary: isDark ? 'text-gray-400' : 'text-stone-600',
                textTertiary: isDark ? 'text-gray-500' : 'text-stone-500',
                input: isDark ? 'bg-slate-700 border-slate-600 text-white placeholder-gray-400' : 'bg-white border-stone-300 text-stone-800 placeholder-stone-400',
                button: isDark ? 'bg-slate-800 text-gray-300 hover:bg-slate-700 border-slate-700' : 'bg-stone-200 text-stone-700 hover:bg-stone-300 border-stone-300',
                buttonActive: isDark ? 'bg-blue-600 text-white' : 'bg-stone-700 text-white',
                taskCard: isDark ? 'bg-slate-800 border-slate-700' : 'bg-white border-stone-200',
                completedCard: isDark ? 'bg-slate-800/50 border-slate-700/50' : 'bg-stone-50 border-stone-200',
                sidebar: isDark ? 'bg-slate-800 border-slate-700' : 'bg-stone-50 border-stone-300',
            };

            if (loading) {
                return (
                    <div className={`min-h-screen ${themeClasses.bg} flex items-center justify-center`}>
                        <div className={themeClasses.textSecondary + " text-lg"}>Loading...</div>
                    </div>
                );
            }

            if (!user) {
                return (
                    <div className={`min-h-screen ${isDark ? 'bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900' : 'bg-gradient-to-br from-stone-200 to-stone-100'} flex items-center justify-center p-6`}>
                        <div className={`${isDark ? 'bg-slate-800 border-slate-700' : 'bg-white border-stone-200'} rounded-xl blitz-shadow-lg p-8 w-full max-w-md border`}>
                            <h1 className={`text-3xl font-bold ${themeClasses.text} mb-2`}>Taskline</h1>
                            <p className={`${themeClasses.textSecondary} mb-6`}>Focus. Prioritize. Get things done.</p>
                            <input
                                type="email"
                                value={email}
                                onChange={(e) => setEmail(e.target.value)}
                                placeholder="Email"
                                className={`w-full px-4 py-3 ${themeClasses.input} border rounded-lg mb-3 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent`}
                            />
                            <input
                                type="password"
                                value={password}
                                onChange={(e) => setPassword(e.target.value)}
                                placeholder="Password"
                                className={`w-full px-4 py-3 ${themeClasses.input} border rounded-lg mb-4 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent`}
                            />
                            <div className="flex gap-3">
                                <button
                                    onClick={signIn}
                                    className="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg py-3 transition"
                                >
                                    Sign In
                                </button>
                                <button
                                    onClick={signUp}
                                    className={`flex-1 ${themeClasses.button} font-medium rounded-lg py-3 transition border`}
                                >
                                    Sign Up
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }

            if (focusMode && isMinimized) {
                return (
                    <div className={`fixed top-4 right-4 ${isDark ? 'bg-slate-800 border-slate-700' : 'bg-white border-stone-300'} rounded-lg blitz-shadow-lg p-4 z-50 border`} style={{ width: '220px' }}>
                        <div className="flex items-center justify-between mb-2">
                            <span className={`text-sm font-medium truncate flex-1 ${themeClasses.text}`}>{focusMode.title}</span>
                            <button onClick={() => setIsMinimized(false)} className={`ml-2 ${isDark ? 'hover:bg-slate-700' : 'hover:bg-stone-100'} rounded p-1`}>
                                <ChevronLeft size={16} className={themeClasses.text} />
                            </button>
                        </div>
                        <div className={`text-4xl font-bold text-center mb-3 tracking-tight ${themeClasses.text}`}>
                            {formatTime(timerSeconds)}
                        </div>
                        <div className="flex gap-2">
                            <button 
                                onClick={() => setIsTimerRunning(!isTimerRunning)}
                                className="flex-1 bg-blue-600 hover:bg-blue-700 rounded-lg py-2 flex items-center justify-center transition text-white"
                            >
                                {isTimerRunning ? <Pause size={16} /> : <Play size={16} />}
                            </button>
                            <button 
                                onClick={exitFocusMode}
                                className="bg-red-600 hover:bg-red-700 rounded-lg py-2 px-3 transition text-white"
                            >
                                <X size={16} />
                            </button>
                        </div>
                    </div>
                );
            }

            if (focusMode) {
                return (
                    <div className={`min-h-screen ${themeClasses.bg} flex items-center justify-center p-6`}>
                        <div className={`${themeClasses.card} rounded-2xl blitz-shadow-lg p-12 max-w-2xl w-full border`}>
                            <div className="flex justify-between items-start mb-10">
                                <div>
                                    <h1 className={`text-4xl font-bold ${themeClasses.text} mb-2`}>{focusMode.title}</h1>
                                    <div className={`inline-block ${getUrgencyColor(focusMode.urgency)} text-white text-xs font-medium px-3 py-1 rounded`}>
                                        {focusMode.urgency === 'urgent' ? 'ðŸ”´ URGENT' : focusMode.urgency === 'semi-urgent' ? 'ðŸŸ¡ SEMI-URGENT' : 'ðŸŸ¢ NOT URGENT'}
                                    </div>
                                </div>
                                <button onClick={() => setIsMinimized(true)} className={`${themeClasses.textSecondary} hover:${themeClasses.text} transition`}>
                                    <ChevronRight size={24} />
                                </button>
                            </div>
                            
                            <div className="text-center mb-12">
                                <div className={`text-8xl font-bold ${themeClasses.text} mb-4 tracking-tight`}>
                                    {formatTime(timerSeconds)}
                                </div>
                                <div className={`text-lg ${themeClasses.textSecondary}`}>
                                    of {focusMode.time} minutes
                                </div>
                                <div className={`mt-6 ${isDark ? 'bg-slate-700' : 'bg-stone-200'} rounded-full h-2 overflow-hidden`}>
                                    <div 
                                        className="bg-blue-600 h-full transition-all duration-300"
                                        style={{ width: `${Math.min((timerSeconds / (focusMode.time * 60)) * 100, 100)}%` }}
                                    />
                                </div>
                            </div>

                            <div className="flex gap-3">
                                <button 
                                    onClick={() => setIsTimerRunning(!isTimerRunning)}
                                    className="flex-1 bg-blue-600 hover:bg-blue-700 text-white rounded-xl py-4 px-6 flex items-center justify-center gap-3 font-medium transition"
                                >
                                    {isTimerRunning ? (
                                        <>
                                            <Pause size={20} />
                                            <span>Pause</span>
                                        </>
                                    ) : (
                                        <>
                                            <Play size={20} />
                                            <span>Start</span>
                                        </>
                                    )}
                                </button>
                                <button 
                                    onClick={() => completeTask(focusMode.id)}
                                    className="flex-1 bg-green-600 hover:bg-green-700 text-white rounded-xl py-4 px-6 flex items-center justify-center gap-3 font-medium transition"
                                >
                                    <Check size={20} />
                                    <span>Complete</span>
                                </button>
                                <button 
                                    onClick={exitFocusMode}
                                    className={`${themeClasses.button} rounded-xl py-4 px-6 flex items-center justify-center font-medium transition border`}
                                >
                                    <X size={20} />
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }

            return (
                <>
                    {/* AI Modal */}
                    {showAIModal && (
                        <div className="fixed inset-0 z-50 flex items-center justify-center p-4 modal-backdrop" style={{ backgroundColor: 'rgba(0,0,0,0.7)' }} onClick={(e) => e.target === e.currentTarget && setShowAIModal(false)}>
                            <div className={`${themeClasses.card} border rounded-2xl p-6 w-full max-w-3xl max-h-[90vh] overflow-y-auto blitz-shadow-lg`}>
                                <div className="flex justify-between items-start mb-4">
                                    <h2 className={`text-2xl font-bold ${themeClasses.text} flex items-center gap-2`}>
                                        <Sparkles size={24} className="text-blue-500" />
                                        AI Assistant (FREE with Groq!)
                                    </h2>
                                    <button onClick={() => setShowAIModal(false)} className={`${themeClasses.textSecondary} hover:${themeClasses.text}`}>
                                        <X size={24} />
                                    </button>
                                </div>

                                {!groqApiKey || groqApiKey === 'YOUR_API_KEY_HERE' || showApiKeyInput ? (
                                    <div className="mb-4">
                                        <label className={`block text-sm font-medium ${themeClasses.text} mb-2`}>
                                            Groq API Key (100% FREE)
                                        </label>
                                        <p className={`text-xs ${themeClasses.textSecondary} mb-2`}>
                                            Get your FREE API key from <a href="https://console.groq.com/" target="_blank" rel="noopener noreferrer" className="text-blue-500 hover:underline">console.groq.com</a> - No credit card required!
                                        </p>
                                        <div className="flex gap-2">
                                            <input
                                                type="password"
                                                value={groqApiKey === 'YOUR_API_KEY_HERE' ? '' : groqApiKey}
                                                onChange={(e) => setGroqApiKey(e.target.value)}
                                                placeholder="gsk_..."
                                                className={`flex-1 px-4 py-2 ${themeClasses.input} border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm`}
                                            />
                                            <button
                                                onClick={saveApiKey}
                                                disabled={!groqApiKey.trim() || groqApiKey === 'YOUR_API_KEY_HERE'}
                                                className="bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white px-4 py-2 rounded-lg font-medium transition"
                                            >
                                                Save
                                            </button>
                                        </div>
                                    </div>
                                ) : (
                                    <button
                                        onClick={() => setShowApiKeyInput(true)}
                                        className={`text-xs ${themeClasses.textSecondary} hover:${themeClasses.text} mb-4`}
                                    >
                                        Change API Key
                                    </button>
                                )}

                                <div className="mb-4">
                                    <label className={`block text-sm font-medium ${themeClasses.text} mb-2`}>
                                        Quick Actions
                                    </label>
                                    <div className="grid grid-cols-2 md:grid-cols-3 gap-2">
                                        {quickActions.map((action, idx) => (
                                            <button
                                                key={idx}
                                                onClick={() => setAiPrompt(action.prompt)}
                                                className={`${themeClasses.button} border px-3 py-2 rounded-lg text-sm font-medium transition text-left`}
                                            >
                                                {action.label}
                                            </button>
                                        ))}
                                    </div>
                                </div>

                                <div className="mb-4">
                                    <label className={`block text-sm font-medium ${themeClasses.text} mb-2`}>
                                        Your Request
                                    </label>
                                    <textarea
                                        value={aiPrompt}
                                        onChange={(e) => setAiPrompt(e.target.value)}
                                        placeholder="What would you like help with?"
                                        className={`w-full px-4 py-3 ${themeClasses.input} border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm min-h-[100px]`}
                                    />
                                </div>

                                <button
                                    onClick={callAI}
                                    disabled={aiLoading || !aiPrompt.trim()}
                                    className="w-full bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white px-6 py-3 rounded-lg font-medium transition flex items-center justify-center gap-2"
                                >
                                    {aiLoading ? (
                                        <>
                                            <div className="w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"></div>
                                            Thinking...
                                        </>
                                    ) : (
                                        <>
                                            <Send size={18} />
                                            Ask AI
                                        </>
                                    )}
                                </button>

                                {aiResponse && (
                                    <div className="mt-6">
                                        <div className="flex justify-between items-center mb-2">
                                            <label className={`block text-sm font-medium ${themeClasses.text}`}>
                                                Response
                                            </label>
                                            <button
                                                onClick={() => copyToClipboard(aiResponse)}
                                                className={`${themeClasses.textSecondary} hover:${themeClasses.text} flex items-center gap-1 text-sm`}
                                            >
                                                <Copy size={16} />
                                                Copy
                                            </button>
                                        </div>
                                        <div className={`${isDark ? 'bg-slate-700' : 'bg-white'} border ${isDark ? 'border-slate-600' : 'border-stone-200'} rounded-lg p-4 whitespace-pre-wrap text-sm ${themeClasses.text}`}>
                                            {aiResponse}
                                        </div>
                                    </div>
                                )}
                            </div>
                        </div>
                    )}

                    {/* Sidebar */}
                    <div className={`fixed right-0 top-1/2 -translate-y-1/2 ${themeClasses.sidebar} border-l border-t border-b rounded-l-2xl p-3 z-40 blitz-shadow-lg flex flex-col gap-3`}>
                        <button
                            onClick={() => setShowAIModal(true)}
                            className="bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white p-3 rounded-xl transition flex items-center justify-center"
                            title="AI Assistant"
                        >
                            <Sparkles size={20} />
                        </button>
                        <button
                            onClick={toggleTheme}
                            className={`${themeClasses.button} border p-3 rounded-xl transition flex items-center justify-center`}
                            title={isDark ? "Notebook Theme" : "Dark Theme"}
                        >
                            {isDark ? <Book size={20} /> : <Moon size={20} />}
                        </button>
                    </div>

                    <div className={`min-h-screen ${themeClasses.bg} pr-20`}>
                        <div className="max-w-6xl mx-auto p-6">
                            <header className="mb-8 flex justify-between items-center">
                                <div>
                                    <h1 className={`text-3xl font-bold ${themeClasses.text} mb-1 ${!isDark ? 'notebook-handwriting text-4xl' : ''}`}>Taskline</h1>
                                    <p className={`text-sm ${themeClasses.textSecondary}`}>{user.email}</p>
                                </div>
                                <button
                                    onClick={signOut}
                                    className={`flex items-center gap-2 px-4 py-2 ${themeClasses.textSecondary} hover:${themeClasses.text} transition`}
                                >
                                    <LogOut size={18} />
                                    <span className="text-sm font-medium">Sign Out</span>
                                </button>
                            </header>

                            <div className="flex gap-2 mb-6">
                                <button 
                                    onClick={() => setView('today')}
                                    className={`px-5 py-2.5 rounded-lg font-medium text-sm transition border ${view === 'today' ? themeClasses.buttonActive : themeClasses.button}`}
                                >
                                    Today
                                </button>
                                <button 
                                    onClick={() => setView('calendar')}
                                    className={`px-5 py-2.5 rounded-lg font-medium text-sm transition flex items-center gap-2 border ${view === 'calendar' ? themeClasses.buttonActive : themeClasses.button}`}
                                >
                                    <Calendar size={16} />
                                    <span>Calendar</span>
                                </button>
                            </div>

                            {view === 'calendar' && (
                                <div className={`${themeClasses.card} rounded-xl blitz-shadow border p-6 mb-6`}>
                                    <div className="flex items-center justify-between mb-6">
                                        <button onClick={() => changeMonth(-1)} className={`p-2 ${isDark ? 'hover:bg-slate-700' : 'hover:bg-stone-100'} rounded-lg transition`}>
                                            <ChevronLeft size={20} className={themeClasses.text} />
                                        </button>
                                        <h2 className={`text-lg font-semibold ${themeClasses.text} ${!isDark ? 'notebook-handwriting text-xl' : ''}`}>
                                            {selectedDate.toLocaleDateString('en-US', { month: 'long', year: 'numeric' })}
                                        </h2>
                                        <button onClick={() => changeMonth(1)} className={`p-2 ${isDark ? 'hover:bg-slate-700' : 'hover:bg-stone-100'} rounded-lg transition`}>
                                            <ChevronRight size={20} className={themeClasses.text} />
                                        </button>
                                    </div>
                                    
                                    <div className="grid grid-cols-7 gap-2">
                                        {['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'].map(day => (
                                            <div key={day} className={`text-center text-xs font-semibold ${themeClasses.textTertiary} py-2`}>
                                                {day}
                                            </div>
                                        ))}
                                        
                                        {(() => {
                                            const { daysInMonth, startingDayOfWeek } = getDaysInMonth(selectedDate);
                                            const days = [];
                                            
                                            for (let i = 0; i < startingDayOfWeek; i++) {
                                                days.push(<div key={`empty-${i}`} />);
                                            }
                                            
                                            for (let day = 1; day <= daysInMonth; day++) {
                                                const date = new Date(selectedDate.getFullYear(), selectedDate.getMonth(), day);
                                                const taskCount = getTasksForDate(date);
                                                const isSelected = date.toISOString().split('T')[0] === selectedDate.toISOString().split('T')[0];
                                                
                                                days.push(
                                                    <button
                                                        key={day}
                                                        onClick={() => setSelectedDate(date)}
                                                        className={`aspect-square p-2 rounded-lg text-sm transition ${
                                                            isSelected 
                                                                ? 'bg-blue-600 text-white' 
                                                                : `${isDark ? 'hover:bg-slate-700' : 'hover:bg-stone-200'} ${themeClasses.text}`
                                                        }`}
                                                    >
                                                        <div className="font-medium">{day}</div>
                                                        {taskCount > 0 && (
                                                            <div className={`text-xs mt-1 ${isSelected ? 'text-blue-200' : 'text-blue-600'}`}>
                                                                {taskCount}
                                                            </div>
                                                        )}
                                                    </button>
                                                );
                                            }
                                            
                                            return days;
                                        })()}
                                    </div>
                                </div>
                            )}

                            <div className={`${themeClasses.card} rounded-xl blitz-shadow border p-6 mb-6`}>
                                <h2 className={`text-lg font-semibold ${themeClasses.text} mb-4 ${!isDark ? 'notebook-handwriting text-xl' : ''}`}>Add New Task</h2>
                                <div className="space-y-3">
                                    <input
                                        type="text"
                                        value={newTaskTitle}
                                        onChange={(e) => setNewTaskTitle(e.target.value)}
                                        placeholder="What needs to be done?"
                                        className={`w-full px-4 py-3 ${themeClasses.input} border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm ${!isDark ? 'notebook-handwriting text-base' : ''}`}
                                        onKeyPress={(e) => e.key === 'Enter' && addTask()}
                                    />
                                    <div className="flex gap-3 flex-wrap">
                                        <div className="flex items-center gap-2">
                                            <Clock size={18} className={themeClasses.textSecondary} />
                                            <input
                                                type="number"
                                                value={newTaskTime}
                                                onChange={(e) => setNewTaskTime(parseInt(e.target.value) || 0)}
                                                className={`w-20 px-3 py-2 ${themeClasses.input} border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm`}
                                            />
                                            <span className={`text-sm ${themeClasses.textSecondary}`}>min</span>
                                        </div>
                                        <input
                                            type="date"
                                            value={newTaskDate}
                                            onChange={(e) => setNewTaskDate(e.target.value)}
                                            className={`px-4 py-2 ${themeClasses.input} border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm`}
                                        />
                                        <select
                                            value={newTaskUrgency}
                                            onChange={(e) => setNewTaskUrgency(e.target.value)}
                                            className={`px-4 py-2 ${themeClasses.input} border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm`}
                                        >
                                            <option value="urgent">ðŸ”´ Urgent</option>
                                            <option value="semi-urgent">ðŸŸ¡ Semi-Urgent</option>
                                            <option value="not-urgent">ðŸŸ¢ Not Urgent</option>
                                        </select>
                                        <button
                                            onClick={addTask}
                                            className="ml-auto bg-blue-600 hover:bg-blue-700 text-white rounded-lg px-6 py-2 flex items-center gap-2 font-medium text-sm transition"
                                        >
                                            <Plus size={18} />
                                            <span>Add Task</span>
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                                <div>
                                    <h2 className={`text-lg font-semibold ${themeClasses.text} mb-4 ${!isDark ? 'notebook-handwriting text-xl' : ''}`}>Active Tasks</h2>
                                    {activeTasks.length === 0 ? (
                                        <div className={`${themeClasses.card} border rounded-xl p-12 text-center`}>
                                            <p className={themeClasses.textTertiary}>No active tasks</p>
                                        </div>
                                    ) : (
                                        <div className="space-y-3">
                                            {activeTasks.map(task => (
                                                <div
                                                    key={task.id}
                                                    draggable
                                                    onDragStart={(e) => handleDragStart(e, task)}
                                                    onDragOver={handleDragOver}
                                                    onDrop={(e) => handleDrop(e, task)}
                                                    onTouchStart={(e) => handleTouchStart(e, task)}
                                                    onTouchMove={handleTouchMove}
                                                    onTouchEnd={(e) => handleTouchEnd(e, task)}
                                                    className={`${themeClasses.taskCard} blitz-shadow border rounded-xl p-4 cursor-move hover:shadow-lg transition ${getUrgencyClass(task.urgency)} ${touchedTask?.id === task.id ? 'opacity-50' : ''}`}
                                                >
                                                    <div className="flex items-start gap-3">
                                                        <GripVertical className={`${isDark ? 'text-gray-600' : 'text-stone-400'} mt-1 flex-shrink-0`} size={18} />
                                                        <div className="flex-1 min-w-0">
                                                            <div className="flex items-start gap-2 mb-2">
                                                                <h3 className={`font-medium ${themeClasses.text} flex-1 ${!isDark ? 'notebook-handwriting text-lg' : ''}`}>{task.title}</h3>
                                                                {isOverdue(task.date) && (
                                                                    <span className="flex items-center gap-1 text-xs text-red-400 bg-red-500/10 px-2 py-1 rounded">
                                                                        <AlertCircle size={12} />
                                                                        Overdue
                                                                    </span>
                                                                )}
                                                            </div>
                                                            <div className={`flex items-center gap-3 text-xs ${themeClasses.textSecondary}`}>
                                                                <div className="flex items-center gap-1">
                                                                    <Clock size={14} />
                                                                    <span>{task.time} min</span>
                                                                </div>
                                                                <div className={`${getUrgencyColor(task.urgency)} text-white px-2 py-1 rounded font-medium`}>
                                                                    {task.urgency === 'urgent' ? 'ðŸ”´ URGENT' : task.urgency === 'semi-urgent' ? 'ðŸŸ¡ SEMI-URGENT' : 'ðŸŸ¢ NOT URGENT'}
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div className="flex gap-2 flex-shrink-0">
                                                            <button
                                                                onClick={() => startFocusMode(task)}
                                                                className="bg-blue-600 hover:bg-blue-700 text-white rounded-lg p-2 transition"
                                                                title="Focus"
                                                            >
                                                                <Play size={16} />
                                                            </button>
                                                            <button
                                                                onClick={() => completeTask(task.id)}
                                                                className="bg-green-600 hover:bg-green-700 text-white rounded-lg p-2 transition"
                                                                title="Complete"
                                                            >
                                                                <Check size={16} />
                                                            </button>
                                                            <button
                                                                onClick={() => deleteTask(task.id)}
                                                                className={`${themeClasses.button} rounded-lg p-2 transition border`}
                                                                title="Delete"
                                                            >
                                                                <X size={16} />
                                                            </button>
                                                        </div>
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    )}
                                </div>

                                <div>
                                    <h2 className={`text-lg font-semibold ${themeClasses.text} mb-4 ${!isDark ? 'notebook-handwriting text-xl' : ''}`}>Completed</h2>
                                    {completedTasks.length === 0 ? (
                                        <div className={`${themeClasses.card} border rounded-xl p-12 text-center`}>
                                            <p className={themeClasses.textTertiary}>No completed tasks</p>
                                        </div>
                                    ) : (
                                        <div className="space-y-3">
                                            {completedTasks.map(task => (
                                                <div
                                                    key={task.id}
                                                    className={`${themeClasses.completedCard} border rounded-xl p-4`}
                                                >
                                                    <div className="flex items-start gap-3">
                                                        <Check className="text-green-500 mt-1 flex-shrink-0" size={18} />
                                                        <div className="flex-1 min-w-0">
                                                            <h3 className={`font-medium ${themeClasses.textSecondary} mb-2 line-through ${!isDark ? 'notebook-handwriting text-lg' : ''}`}>{task.title}</h3>
                                                            <div className={`flex items-center gap-3 text-xs ${themeClasses.textTertiary}`}>
                                                                <div className="flex items-center gap-1">
                                                                    <Clock size={14} />
                                                                    <span>{task.time} min</span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <button
                                                            onClick={() => deleteTask(task.id)}
                                                            className={`${themeClasses.button} rounded-lg p-2 transition flex-shrink-0 border`}
                                                            title="Delete"
                                                        >
                                                            <X size={16} />
                                                        </button>
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    )}
                                </div>
                            </div>
                        </div>
                    </div>
                </>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<FocusTaskManager />);
    </script>
</body>
</html>
